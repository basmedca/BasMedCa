<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">

<!-- iOS Support -->
<link rel="apple-touch-icon" href="logo.png">
<link rel="apple-touch-startup-image" href="logo.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="BasMedCa">

<!-- Android/Chrome -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="application-name" content="BasMedCa">

<!-- Theme Color for PWA -->
<meta name="theme-color" content="#0077b6">

<!-- For Microsoft Edge -->
<meta name="msapplication-TileColor" content="#0077b6">
<meta name="msapplication-TileImage" content="logo.png">
<meta name="msapplication-config" content="none">
  <title>BasMedCa - Basic Medical Care</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    /* Reset & base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body, html {
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f8f9fa 0%, #90e0ef 100%);
      color: #2d3748;
      line-height: 1.6;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    
    /* Navbar - Updated Design */
    .navbar {
      background-color: #0077b6;
      color: white;
      padding: 12px 0;
      position: fixed;
      width: 100%;
      top: 0;
      left: 0;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .navbar-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 900px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .navbar-brand {
      color: white;
      font-size: 1.6rem;
      font-weight: 700;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .navbar-logo {
      height: 36px;
      width: 36px;
      object-fit: contain;
    }
    
    .nav-links {
      list-style: none;
      display: flex;
      gap: 30px;
    }
    
    .nav-link-item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .nav-link-main {
      color: white;
      text-decoration: none;
      font-size: 1rem;
      font-weight: 600;
      transition: color 0.3s ease;
    }
    
    .nav-link-main:hover {
      color: #caf0f8;
    }
    
    .nav-translation {
      font-style: italic;
      font-size: 0.8rem;
      color: #caf0f8;
      margin-top: 2px;
    }
    
    /* Pages */
    .page {
      display: none;
      min-height: 100vh;
      padding-top: 80px;
      padding-bottom: 60px;
    }
    
    .page.active {
      display: block;
    }
    
    /* Hero Page - Cleaner Design */
    .hero-container {
      text-align: center;
      padding: 40px 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .hero-title {
      font-size: 3.5rem;
      color: #0077b6;
      margin-bottom: 20px;
      line-height: 1.2;
    }
    
    .hero-subtitle {
      font-size: 1.5rem;
      margin-bottom: 30px;
      color: #023e8a;
    }
    
    .mission-vision-container {
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      padding: 25px;
      margin: 30px auto;
      max-width: 700px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .mission-vision {
      font-size: 1.1rem;
      margin-bottom: 15px;
      line-height: 1.5;
      color: #023e8a;
    }
    
    .disclaimer {
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 12px;
      padding: 20px;
      margin: 30px auto;
      max-width: 800px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      font-size: 0.95rem;
      color: #023e8a;
      text-align: left;
    }
    
    /* Buttons - Cleaner Design */
    .btn-primary,
    .btn-secondary,
    .btn-exit {
      padding: 14px 28px;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      min-width: 160px;
    }
    
    .btn-primary {
      background-color: #0077b6;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #0096c7;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 119, 182, 0.3);
    }
    
    .btn-secondary {
      background-color: #90e0ef;
      color: #0077b6;
      margin-top: 20px;
    }
    
    .btn-secondary:hover {
      background-color: #caf0f8;
      transform: translateY(-2px);
    }
    
    /* Updated Exit Button - Not Red */
    .btn-exit {
      position: relative;
      background-color: #0077b6;
      color: white;
      padding: 12px 20px;
      font-size: 1rem;
      margin-bottom: 25px;
      width: auto;
      min-width: 140px;
    }
    
    .btn-exit:hover {
      background-color: #0096c7;
      transform: translateY(-2px);
    }
    
    /* Dashboard */
    .dashboard-container {
      text-align: center;
      padding: 20px;
    }
    
    .dashboard-title {
      font-size: 2.2rem;
      color: #0077b6;
      margin-bottom: 15px;
    }
    
    .welcome-text {
      font-size: 1.2rem;
      margin-bottom: 40px;
      color: #023e8a;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .feature-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .feature-card {
      background: white;
      border-radius: 15px;
      padding: 30px 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    
    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }
    
    .feature-card i {
      font-size: 3.2rem;
      color: #4caf50;
      margin-bottom: 20px;
    }
    
    .feature-card h3 {
      font-size: 1.4rem;
      color: #0077b6;
      margin-bottom: 10px;
    }
    
    .card-translation {
      font-style: italic;
      font-size: 0.9rem;
      color: #023e8a;
      margin-top: 5px;
    }
    
    /* Feature Detail Page */
    .feature-detail-container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      max-width: 850px;
      margin: 0 auto;
    }
    
    .feature-detail-heading {
      color: #0077b6;
      text-align: center;
      margin-bottom: 10px;
      font-size: 2rem;
    }
    
    .feature-detail-translation {
      text-align: center;
      color: #023e8a;
      font-style: italic;
      margin-bottom: 30px;
      font-size: 1rem;
    }
    
    /* Feature Sections */
    .feature-section {
      max-width: 800px;
      margin: 0 auto;
    }
    
    /* Search Box */
    .search-wrapper {
      margin-bottom: 25px;
    }
    
    .search-box {
      width: 100%;
      padding: 14px 18px;
      font-size: 1rem;
      border: 2px solid #90e0ef;
      border-radius: 10px;
      outline: none;
      transition: border-color 0.3s ease;
      background-color: #f8f9fa;
    }
    
    .search-box:focus {
      border-color: #0077b6;
      box-shadow: 0 0 0 3px rgba(0, 119, 182, 0.2);
    }
    
    .search-translation {
      text-align: left;
      margin-top: 8px;
      font-size: 0.9rem;
      color: #023e8a;
      padding-left: 5px;
    }
    
    /* UPDATED: Medicine Alarms with Labels and Day Selection */
    .alarm-form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    .form-group-full {
      grid-column: 1 / -1;
    }
    
    .form-label {
      margin-bottom: 8px;
      font-weight: 600;
      color: #0077b6;
      display: flex;
      flex-direction: column;
    }
    
    .label-translation {
      font-style: italic;
      font-size: 0.85rem;
      color: #023e8a;
      font-weight: normal;
      margin-top: 2px;
    }
    
    .alarm-input,
    .alarm-select {
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #90e0ef;
      font-size: 1rem;
      width: 100%;
      background-color: #f8f9fa;
    }
    
    .alarm-btn-container {
      display: flex;
      align-items: flex-end;
    }
    
    .alarm-btn {
      background: #0077b6;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      padding: 14px 20px;
      transition: background-color 0.3s ease;
      width: 100%;
      font-weight: 600;
      height: 46px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .alarm-btn:hover {
      background: #0096c7;
    }
    
    /* Day Selection Container */
    .days-selection-container {
      background-color: #f0f8ff;
      border-radius: 10px;
      padding: 20px;
      margin-top: 15px;
      border: 1px solid #90e0ef;
      display: none;
    }
    
    .days-selection-container.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    .days-selection-title {
      font-weight: 600;
      color: #0077b6;
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
    }
    
    .days-selection-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
    }
    
    .day-checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 8px;
      transition: all 0.2s ease;
      background-color: white;
      border: 1px solid #90e0ef;
    }
    
    .day-checkbox:hover {
      background-color: #e0f2f7;
    }
    
    .day-checkbox.selected {
      background-color: #0077b6;
      color: white;
      border-color: #0077b6;
    }
    
    .day-checkbox input {
      display: none;
    }
    
    .day-checkbox .checkmark {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      border: 2px solid #90e0ef;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    
    .day-checkbox.selected .checkmark {
      background-color: white;
      border-color: white;
    }
    
    .day-checkbox.selected .checkmark::after {
      content: 'âœ“';
      color: #0077b6;
      font-weight: bold;
    }
    
    .day-name {
      font-weight: 500;
    }
    
    .alarm-list {
      max-height: 350px;
      overflow-y: auto;
      border-top: 1px solid #90e0ef;
      padding-top: 20px;
      margin-top: 30px;
    }
    
    .alarm-list-header {
      font-size: 1.3rem;
      color: #0077b6;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .alarm-list-header .translation {
      display: block;
      font-size: 0.9rem;
      margin-top: 5px;
    }
    
    .alarm-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #e0f2f7;
      background-color: #f0f8ff;
      border-radius: 10px;
      margin-bottom: 12px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }
    
    .alarm-details {
      flex: 1;
    }
    
    .alarm-time {
      font-weight: 700;
      font-size: 1.2rem;
      color: #0077b6;
      margin-bottom: 5px;
    }
    
    .alarm-medicine-info {
      font-size: 1rem;
      color: #023e8a;
      margin-bottom: 3px;
    }
    
    .alarm-frequency {
      font-size: 0.9rem;
      color: #666;
      font-style: italic;
    }
    
    .deleteAlarmBtn {
      background: #e63946;
      border: none;
      color: #fff;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 0.9rem;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background-color 0.3s ease;
      flex-shrink: 0;
      margin-left: 15px;
    }
    
    .deleteAlarmBtn:hover {
      background: #d62828;
    }
    
    .deleteAlarmBtn .translation {
      display: none;
    }
    
    /* Medicine Dictionary */
    .medicine-list {
      max-height: 450px;
      overflow-y: auto;
      border-top: 1px solid #90e0ef;
      padding-top: 20px;
    }
    
    .medicine-category {
      margin-bottom: 20px;
      border: 1px solid #90e0ef;
      border-radius: 12px;
      background-color: #f0f8ff;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
    }
    
    .category-header {
      cursor: pointer;
      padding: 18px 20px;
      font-weight: 700;
      font-size: 1.2rem;
      color: #0077b6;
      user-select: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .category-header:hover {
      background-color: #e0f2f7;
    }
    
    .category-content {
      padding: 10px 20px 20px 20px;
      display: block;
    }
    
    .medicine-item {
      padding: 15px 0;
      border-bottom: 1px solid #e0f2f7;
    }
    
    .medicine-item h4 {
      margin-bottom: 8px;
      color: #0077b6;
      font-size: 1.2rem;
    }
    
    .medicine-item p {
      margin: 0;
      font-size: 1rem;
      color: #333;
      line-height: 1.6;
    }
    
    .step-translation {
      display: block;
      margin-top: 6px;
      font-size: 0.95rem;
      color: #666;
      font-style: italic;
    }
    
    /* Emergency Guide */
    .emergency-list {
      max-height: 500px;
      overflow-y: auto;
      border-top: 1px solid #90e0ef;
      padding-top: 20px;
    }
    
    .emergency-card {
      border: 1px solid #90e0ef;
      border-radius: 12px;
      background-color: #f0f8ff;
      margin-bottom: 18px;
      padding: 18px 20px;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
      user-select: none;
    }
    
    .emergency-card:hover {
      background-color: #e0f2f7;
    }
    
    .emergency-card h3 {
      color: #0077b6;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.3rem;
    }
    
    .emergency-steps {
      margin-top: 15px;
      padding-left: 20px;
    }
    
    .emergency-steps ol {
      list-style-position: inside;
      padding-left: 0;
    }
    
    .emergency-steps li {
      margin-bottom: 15px;
      color: #333;
      font-size: 1rem;
      line-height: 1.6;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      padding-left: 10px;
    }
    
    .step-text {
      margin-bottom: 5px;
    }
    
    .step-translation {
      font-style: italic;
      color: #666;
      font-size: 0.95em;
      margin-bottom: 8px;
    }
    
    .step-image {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      margin-top: 10px;
      align-self: center;
    }
    
    /* About Page */
    .about-container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      max-width: 800px;
      margin: 0 auto;
    }
    
    .about-container h2 {
      color: #0077b6;
      margin-bottom: 25px;
      font-size: 2rem;
      text-align: center;
    }
    
    .about-container h3 {
      color: #0077b6;
      margin: 25px 0 15px;
      font-size: 1.5rem;
    }
    
    .about-container p {
      margin-bottom: 15px;
      color: #333;
      line-height: 1.6;
    }
    
    .developer-info {
      background-color: #f0f8ff;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
    }
    
    .developer-info p {
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid #e0f2f7;
    }
    
    .developer-info p:last-child {
      border-bottom: none;
    }
    
    .contact-email {
      background-color: #e0f2f7;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    
    .contact-email a {
      color: #0077b6;
      font-weight: bold;
      text-decoration: none;
      font-size: 1.1rem;
    }
    
    .contact-email a:hover {
      text-decoration: underline;
    }
    
    /* Emergency Hotlines Bar - SIMPLIFIED VERSION */
    .emergency-contacts {
      background-color: #0077b6;
      color: white;
      padding: 12px 0;
      position: fixed;
      bottom: 0;
      width: 100%;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
      z-index: 999;
    }
    
    .emergency-contacts .contacts-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 20px;
      text-align: center;
    }
    
    #emergencyHotlinesToggle {
      cursor: pointer;
      font-size: 1.1rem;
      margin-bottom: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      user-select: none;
      transition: color 0.3s ease;
      background: none;
      border: none;
      color: white;
      width: 100%;
    }
    
    #emergencyHotlinesToggle:hover {
      color: #caf0f8;
    }
    
    #emergencyHotlinesToggle i.fa-chevron-down {
      transition: transform 0.3s ease;
    }
    
    .hotlines-content {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out;
      padding: 0 10px;
    }
    
    .hotlines-content.open {
      max-height: 200px;
      padding-bottom: 15px;
      margin-top: 10px;
    }
    
    .contact-item {
      background-color: #f0f8ff;
      padding: 12px 15px;
      border-radius: 10px;
      border: 2px solid #90e0ef;
      min-width: 150px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #023e8a;
    }
    
    .contact-item:hover {
      background-color: #e0f2f7;
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .contact-item strong {
      color: #0077b6;
      display: block;
      margin-bottom: 5px;
      font-size: 1rem;
    }
    
    .contact-item a {
      color: #023e8a;
      font-weight: 600;
      text-decoration: none;
      font-size: 1rem;
    }
    
    .contact-item a:hover {
      text-decoration: underline;
    }
    
    .contact-translation {
      font-style: italic;
      font-size: 0.85rem;
      color: #023e8a;
      margin-top: 4px;
    }
    
    /* General Translation Styling */
    .translation {
      font-style: italic;
      font-size: 0.9rem;
      color: #023e8a;
      display: block;
      margin-top: 4px;
    }
    
    /* Update Notification */
    .update-notification {
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: #4caf50;
      color: white;
      padding: 15px 20px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
      z-index: 10001;
      display: none;
      align-items: center;
      gap: 12px;
      max-width: 300px;
      animation: slideInRight 0.3s ease;
    }
    
    .update-notification.show {
      display: flex;
    }
    
    .update-button {
      background: white;
      color: #4caf50;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    /* Improved Alarm Alert with Better Timing */
    .alarm-active-notification {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(248, 249, 250, 0.95);
      z-index: 10000;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      backdrop-filter: blur(5px);
    }
    
    .alarm-modal {
      background: white;
      border-radius: 20px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 15px 40px rgba(0, 119, 182, 0.2);
      border: 3px solid #0077b6;
      animation: gentlePulse 2s infinite;
    }
    
    @keyframes gentlePulse {
      0% { box-shadow: 0 15px 40px rgba(0, 119, 182, 0.2); }
      50% { box-shadow: 0 15px 40px rgba(0, 119, 182, 0.4); }
      100% { box-shadow: 0 15px 40px rgba(0, 119, 182, 0.2); }
    }
    
    .alarm-icon {
      width: 100px;
      height: 100px;
      background: linear-gradient(135deg, #0077b6, #0096c7);
      border-radius: 50%;
      margin: 0 auto 25px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .alarm-icon i {
      font-size: 3rem;
      color: white;
    }
    
    .alarm-time-display {
      font-size: 3rem;
      font-weight: bold;
      color: #0077b6;
      margin: 20px 0;
      font-family: monospace;
    }
    
    .alarm-controls {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .alarm-controls button {
      flex: 1;
      min-width: 140px;
      padding: 15px;
      border-radius: 12px;
      font-weight: bold;
      font-size: 1.1rem;
      cursor: pointer;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: all 0.3s ease;
    }
    
    .alarm-dismiss {
      background: linear-gradient(135deg, #4caf50, #45a049);
      color: white;
    }
    
    .alarm-snooze {
      background: white;
      color: #0077b6;
      border: 2px solid #0077b6;
    }
    
    .alarm-dismiss:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
    }
    
    .alarm-snooze:hover {
      background: #0077b6;
      color: white;
      transform: translateY(-3px);
    }
    
    /* PWA Install Button - FIXED */
    .install-pwa-button {
      position: fixed;
      bottom: 100px;
      right: 20px;
      background: linear-gradient(135deg, #0077b6, #0096c7);
      color: white;
      border: none;
      padding: 14px 24px;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(0, 119, 182, 0.3);
      z-index: 9999;
      display: none; /* Hidden by default */
      align-items: center;
      gap: 10px;
      font-weight: 600;
      font-size: 1rem;
      animation: pulse 2s infinite;
      transition: all 0.3s ease;
    }
    
    .install-pwa-button:hover {
      background: linear-gradient(135deg, #0096c7, #00b4d8);
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0, 119, 182, 0.4);
    }
    
    @keyframes pulse {
      0% { transform: scale(1); box-shadow: 0 6px 20px rgba(0, 119, 182, 0.3); }
      50% { transform: scale(1.05); box-shadow: 0 8px 25px rgba(0, 119, 182, 0.4); }
      100% { transform: scale(1); box-shadow: 0 6px 20px rgba(0, 119, 182, 0.3); }
    }
    
    .pwa-installed #emergencyFooter {
      bottom: 0;
    }
    
    /* Battery optimization warning for alarms */
    .battery-warning {
      background: #fff3cd;
      border: 1px solid #ffc107;
      color: #856404;
      padding: 12px 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-size: 0.9rem;
    }
    
    .battery-warning i {
      color: #ffc107;
      margin-right: 8px;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      
      .navbar-container {
        flex-direction: column;
        gap: 10px;
        padding: 0 15px;
      }
      
      .nav-links {
        gap: 20px;
      }
      
      .nav-link-main {
        font-size: 0.95rem;
      }
      
      .nav-translation {
        font-size: 0.75rem;
      }
      
      .page {
        padding-top: 100px;
        padding-bottom: 80px;
      }
      
      .hero-title {
        font-size: 2.5rem;
      }
      
      .hero-subtitle {
        font-size: 1.2rem;
      }
      
      .feature-cards {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .feature-card {
        padding: 25px 15px;
      }
      
      .alarm-form-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .alarm-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }
      
      .deleteAlarmBtn {
        align-self: flex-end;
        margin-left: 0;
      }
      
      .emergency-contacts {
        padding: 10px 0;
      }
      
      .hotlines-content {
        gap: 12px;
      }
      
      .contact-item {
        min-width: 130px;
        padding: 10px 12px;
      }
      
      .feature-detail-container {
        padding: 20px 15px;
      }
      
      .btn-exit {
        width: 100%;
        margin-bottom: 20px;
      }
      
      .mission-vision-container, .disclaimer {
        padding: 20px 15px;
      }
      
      .hotlines-content.open {
        max-height: 300px;
      }
      
      .alarm-time-display {
        font-size: 2.5rem;
      }
      
      .alarm-controls {
        flex-direction: column;
      }
      
      .alarm-controls button {
        width: 100%;
      }
      
      .update-notification {
        bottom: 100px;
        left: 20px;
        right: 20px;
        max-width: none;
      }
      
      .install-pwa-button {
        bottom: 120px;
        right: 15px;
        left: 15px;
        justify-content: center;
      }
      
      .days-selection-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 480px) {
      .hero-title {
        font-size: 2rem;
      }
      
      .hero-subtitle {
        font-size: 1.1rem;
      }
      
      .dashboard-title {
        font-size: 1.8rem;
      }
      
      .nav-links {
        gap: 15px;
      }
      
      .btn-primary, .btn-secondary, .alarm-btn {
        width: 100%;
        padding: 16px;
      }
      
      .feature-detail-heading {
        font-size: 1.6rem;
      }
      
      .contact-item {
        min-width: 45%;
      }
      
      .hotlines-content.open {
        max-height: 400px;
      }
      
      .form-label {
        font-size: 0.95rem;
      }
      
      .label-translation {
        font-size: 0.8rem;
      }
      
      .install-pwa-button {
        font-size: 0.9rem;
        padding: 12px 20px;
      }
      
      .days-selection-grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* Utility Classes */
    .text-center {
      text-align: center;
    }
    
    .mb-20 {
      margin-bottom: 20px;
    }
    
    .mb-30 {
      margin-bottom: 30px;
    }
    
    .mt-20 {
      margin-top: 20px;
    }
    
    .mt-30 {
      margin-top: 30px;
    }
    
    /* Animation for page transitions */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .page.active {
      animation: fadeIn 0.4s ease;
    }
    
    /* Scrollbar Styling */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #90e0ef;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #0077b6;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Navigation Bar - Updated Design -->
    <nav class="navbar">
      <div class="navbar-container">
        <a href="#" class="navbar-brand" id="homeNavBtn">
          <img src="logo.png" class="navbar-logo" alt="BasMedCa Logo" width="36" height="36">
          BasMedCa
        </a>
        <ul class="nav-links">
          <li class="nav-link-item">
            <a href="#" id="dashboardNavBtn" class="nav-link-main">Dashboard</a>
            <span class="nav-translation">(Dashboard)</span>
          </li>
          <li class="nav-link-item">
            <a href="#" id="installCheckBtn" class="nav-link-main">Check Install</a>
            <span class="nav-translation">(Kitaen Install)</span>
          </li>
          <li class="nav-link-item">
            <a href="#" id="aboutNavBtn" class="nav-link-main">About</a>
            <span class="nav-translation">(Maipapan)</span>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Hero Page -->
    <section id="heroPage" class="page active">
      <div class="container hero-container">
        <h1 class="hero-title">BasMedCa</h1>
        <p class="hero-subtitle">Your Personal Health Companion 
          <span class="translation">(Ang Iyong Personal na Kaibigan Pagdating sa Kalusugan)</span>
        </p>
        
        <div class="mission-vision-container">
          <p class="mission-vision">
            <strong>Mission:</strong> To provide accessible basic medical information and tools for everyone. 
            <span class="translation">(Ti Misyon: Mangipaay ti madanon a basic medical information ken ramit para iti amin.)</span>
          </p>
          <p class="mission-vision">
            <strong>Vision:</strong> A world where everyone has access to basic healthcare knowledge. 
            <span class="translation">(Ti Panagdangad: Ti lubong a pagyanan ti amin ket adda access iti basic healthcare knowledge.)</span>
          </p>
        </div>
        
        <div class="disclaimer">
          <p><strong>Disclaimer:</strong> We're not medical professionals. The info here is only for basic knowledge about common medicine and simple emergencies. For serious conditions, emergencies, or medicine dosages, always talk to your doctor.</p>
          <p class="translation">(Disclaimer: Saan kami a propesyonal nga mang-agas. Ti impormasyon ditoy ket para laeng iti basit a pannakaammo maipanggep kadagiti agas ken simple a emergency. No seryoso ti sakit wenno kasapulan ti eksaktong dosage ti agas, agpakita iti doktor mo.)</p>
        </div>
        
        <button id="getStartedBtn" class="btn-primary">
          <i class="fas fa-play-circle"></i> Get Started 
          <span class="translation">(Mangrugi)</span>
        </button>
      </div>
    </section>

    <!-- Dashboard Page -->
    <section id="dashboardPage" class="page">
      <div class="container dashboard-container">
        <h2 class="dashboard-title">Welcome to BasMedCa Dashboard</h2>
        <p class="dashboard-title translation">(Naawat ka iti BasMedCa Dashboard)</p>
        
        <p id="welcomeUser" class="welcome-text">
          Hello! You are using BasMedCa as a guest.
          <span class="translation">(Kumusta! Agususar ka iti BasMedCa kas meysa a bisita.)</span>
        </p>
        
        <div class="feature-cards">
          <div class="feature-card" data-feature="alarms">
            <i class="fas fa-bell"></i>
            <h3>Medicine Alarms</h3>
            <p class="card-translation">(Para Palagip iti Oras ti Panagtumar)</p>
          </div>
          
          <div class="feature-card" data-feature="dictionary">
            <i class="fas fa-book-medical"></i>
            <h3>Medicine Dictionary</h3>
            <p class="card-translation">(Diksyonaryo ti Agas)</p>
          </div>
          
          <div class="feature-card" data-feature="emergency">
            <i class="fas fa-ambulance"></i>
            <h3>Emergency Guide</h3>
            <p class="card-translation">(Bayabay para iti Saan nga Mapakpakadaan a Pasamak)</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Feature Detail Pages -->
    <section id="featureDetailPage" class="page">
      <div class="container feature-detail-container">
        <button id="exitFeatureBtn" class="btn-exit">
          <i class="fas fa-arrow-left"></i> Back to Dashboard
          <span class="translation">(Agsubli iti Dashboard)</span>
        </button>
        
        <h2 id="featureDetailHeading" class="feature-detail-heading"></h2>
        <p id="featureDetailHeadingTranslation" class="feature-detail-translation"></p>

        <!-- UPDATED: Medicine Alarms Feature with Day Selection -->
        <div id="alarmsFeature" class="feature-section" style="display: none;">
          <div class="alarm-form-grid">
            <div class="form-group">
              <label class="form-label">
                Medicine Name
                <span class="label-translation">(Nagan ti Agas)</span>
              </label>
              <input type="text" id="medicineName" placeholder="Enter medicine name" class="alarm-input" />
            </div>
            
            <div class="form-group">
              <label class="form-label">
                Alarm Time
                <span class="label-translation">(Oras ti Panagtumar)</span>
              </label>
              <input type="time" id="alarmTime" class="alarm-input" />
            </div>
            
            <div class="form-group">
              <label class="form-label">
                Frequency
                <span class="label-translation">(Kasano a Damdamo)</span>
              </label>
              <select id="frequency" class="alarm-select">
                <option value="daily">Daily (Inaldaw-aldaw)</option>
                <option value="weekly">Weekly (Linawas)</option>
                <option value="custom">Custom (Naisina a Oras)</option>
              </select>
            </div>
            
            <div class="form-group alarm-btn-container">
              <button id="addAlarmBtn" class="alarm-btn">
                <i class="fas fa-bell"></i> Set Alarm
                <span class="translation">(I-set ti Alarma)</span>
              </button>
            </div>
            
            <!-- Day Selection Container -->
            <div class="form-group-full">
              <div id="daysSelectionContainer" class="days-selection-container">
                <div class="days-selection-title">
                  Select Days
                  <span class="label-translation">(Pilian Dagiti Aldaw)</span>
                </div>
                <div id="daysSelectionGrid" class="days-selection-grid">
                  <!-- Days will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
          
          <div class="alarm-list">
            <h3 class="alarm-list-header">
              Your Medicine Alarms
              <span class="translation">(Pagpalagip ti Panagtumar ti Agas)</span>
            </h3>
            <div id="alarmList"></div>
          </div>
          
          <div class="battery-warning mt-30">
            <i class="fas fa-info-circle"></i>
            <strong>Important:</strong> For alarms to work properly on mobile devices, please:
            <ol style="margin-top: 10px; margin-left: 20px;">
              <li>Keep BasMedCa open or running in the background</li>
              <li>Disable battery optimization for this app in your device settings</li>
              <li>Ensure notifications are enabled</li>
            </ol>
            <span class="translation" style="display: block; margin-top: 10px;">
              (Importante: Tapno agtrabaho dagiti alarma iti cellphone, pangngaasi: 1. Baybay-an nga aglukat wenno agtrabaho iti background ti BasMedCa 2. I-disable ti battery optimization para iti daytoy nga app iti settings ti cellphone 3. Siguraduem nga enable ti notifications.)
            </span>
          </div>
        </div>

        <!-- Medicine Dictionary Feature -->
        <div id="dictionaryFeature" class="feature-section" style="display: none;">
          <div class="search-wrapper">
            <input type="text" id="medicineSearch" placeholder="Search for medicines..." class="search-box" />
            <p class="search-translation">Search for medicines... <span class="translation">(Agbiruk ti agas...)</span></p>
          </div>
          <div id="medicineList" class="medicine-list"></div>
        </div>

        <!-- Emergency Guide Feature -->
        <div id="emergencyFeature" class="feature-section" style="display: none;">
          <div class="search-wrapper">
            <input type="text" id="emergencySearch" placeholder="Search emergencies..." class="search-box" />
            <p class="search-translation">Search emergencies... <span class="translation">(Agbiruk ti emerhensya...)</span></p>
          </div>
          <div id="emergencyList" class="emergency-list"></div>
        </div>
      </div>
    </section>

    <!-- About Page -->
    <section id="aboutPage" class="page">
      <div class="container about-container">
        <h2>About BasMedCa</h2>
        <p class="translation text-center">(Maipapan ti BasMedCa)</p>

        <h3>Our Purpose</h3>
        <p class="translation">(Ti Panggep Mi)</p>
        <p>BasMedCa aims to provide basic medical care assistance through digital tools. Our goal is to empower individuals to manage their health more effectively by offering features like medicine reminders, a medical dictionary, and an emergency guide.</p>
        <p class="translation">(Mangit-ited ti BasMedCa a mangipaay ti basic medical care assistance babaen ti digital tools. Ti panggep mi ket a mangpadur-as iti tao a mangtaripato iti salun-atda a naimbag babaen ti panangipaay ti features a kas medicine reminders, a medical dictionary, ken emergency guide.)</p>

        <h3>The Developers</h3>
        <p class="translation">(Dagiti Nangaramid)</p>
        <div class="developer-info">
          <p><strong>Eizel Zaila A. Dugay</strong></p>
          <p><strong>Frances Seah A. Filog</strong></p>
          <p><strong>Maya Beanca R. Libantino</strong></p>
          <p><strong>Dhezza Mae B. Natabio</strong></p>
          <p><strong>Giselah Mariam A. Ricafrente</strong></p>
        </div>
        
        <h3>Contact Us</h3>
        <p class="translation">(Makipag-iterate Kamin)</p>
        <div class="contact-email">
          <p><strong>Email us at:</strong></p>
          <p>
            <a href="mailto:basmedca@gmail.com?subject=BasMedCa%20Inquiry&body=Hello%20BasMedCa%20Team,">
              <i class="fas fa-envelope"></i> basmedca@gmail.com
            </a>
          </p>
          <p class="translation">(I-email kami iti: basmedca@gmail.com)</p>
        </div>
        
        <button id="exitAboutBtn" class="btn-secondary">
          <i class="fas fa-arrow-left"></i> Back to Dashboard
          <span class="translation">(Agsubli iti Dashboard)</span>
        </button>
      </div>
    </section>
  </div>

  <!-- Update Notification -->
  <div id="updateNotification" class="update-notification">
    <i class="fas fa-sync-alt fa-spin"></i>
    <div>
      <strong>Update Available</strong>
      <p>A new version is ready to install.</p>
      <p class="translation" style="font-size: 0.8rem;">(Adda baro a version a ma-install.)</p>
    </div>
    <button id="updateButton" class="update-button">Update</button>
  </div>

  <!-- PWA Install Button (shown only when installable) -->
  <button id="installPWAButton" class="install-pwa-button">
    <i class="fas fa-download"></i> Install App
    <span class="translation" style="font-size: 0.8rem; font-weight: normal;">(I-install ti App)</span>
  </button>

  <!-- Emergency Hotlines Bar -->
  <footer class="emergency-contacts" id="emergencyFooter">
    <div class="contacts-container">
      <button id="emergencyHotlinesToggle" aria-expanded="false">
        <i class="fas fa-phone-alt"></i> Emergency Hotlines 
        <span class="translation">(Agiti Matawagan nu Adda Ti Pasamak)</span>
        <i class="fas fa-chevron-down"></i>
      </button>
      <div id="hotlinesContent" class="hotlines-content">
        <!-- Hotline numbers will be inserted here by JavaScript -->
      </div>
    </div>
  </footer>

  <script>
    // ===========================
    // APP CONFIGURATION
    // ===========================
    let alarms = JSON.parse(localStorage.getItem('mediCareAlarms')) || [];
    let currentAlarmActive = false;
    let currentAlarmSoundInterval = null;
    let currentAlarmAudioContext = null;
    let deferredPrompt = null; // For PWA installation
    
    // Day configuration
    const DAYS = [
      { id: 'sun', name: 'Sunday', short: 'Sun', translation: '(Dominggo)' },
      { id: 'mon', name: 'Monday', short: 'Mon', translation: '(Lunes)' },
      { id: 'tue', name: 'Tuesday', short: 'Tue', translation: '(Martes)' },
      { id: 'wed', name: 'Wednesday', short: 'Wed', translation: '(Mierkoles)' },
      { id: 'thu', name: 'Thursday', short: 'Thu', translation: '(Huebes)' },
      { id: 'fri', name: 'Friday', short: 'Fri', translation: '(Biernes)' },
      { id: 'sat', name: 'Saturday', short: 'Sat', translation: '(Sabado)' }
    ];
    
    // Platform detection
    const platform = {
      isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
      isIOS: /iPhone|iPad|iPod/i.test(navigator.userAgent),
      isAndroid: /Android/i.test(navigator.userAgent),
      isStandalone: window.matchMedia('(display-mode: standalone)').matches || 
                   window.navigator.standalone === true
    };
    
    // Enhanced installation detection
    const installationMethods = {
      isInstalled: function() {
        // Check multiple methods for better cross-platform detection
        const methods = [
          // Method 1: Display mode (standard)
          window.matchMedia('(display-mode: standalone)').matches,
          
          // Method 2: iOS standalone mode
          window.navigator.standalone === true,
          
          // Method 3: Check for presence of beforeinstallprompt event handler
          // If beforeinstallprompt was fired but app was installed, it won't fire again
          localStorage.getItem('pwaInstalled') === 'true',
          
          // Method 4: Check for service worker scope
          // This is more reliable for desktop installations
          this.isServiceWorkerControlled()
        ];
        
        // Return true if any method indicates installation
        return methods.some(method => method === true);
      },
      
      isServiceWorkerControlled: function() {
        return navigator.serviceWorker && navigator.serviceWorker.controller;
      },
      
      markAsInstalled: function() {
        localStorage.setItem('pwaInstalled', 'true');
      }
    };
    
    // DOM Elements
    const pages = {
      hero: document.getElementById('heroPage'),
      dashboard: document.getElementById('dashboardPage'),
      featureDetail: document.getElementById('featureDetailPage'),
      about: document.getElementById('aboutPage')
    };
    
    // ===========================
    // INITIALIZATION
    // ===========================
    function init() {
      showPage('hero');
      
      // Load and schedule alarms
      alarms.forEach(alarm => {
        if (alarm.active) {
          scheduleAlarm(alarm);
        }
      });
      
      // Initialize PWA features
      initPWA();
      
      // Initialize emergency contacts
      renderEmergencyContacts();
      
      // Check if app is already installed
      if (installationMethods.isInstalled()) {
        document.body.classList.add('pwa-installed');
        document.getElementById('installPWAButton').style.display = 'none';
      }
    }
    
    // ===========================
    // PAGE NAVIGATION
    // ===========================
    function showPage(pageName) {
      Object.values(pages).forEach(page => page.classList.remove('active'));
      if (pages[pageName]) {
        pages[pageName].classList.add('active');
      }
      
      if (pageName === 'dashboard') {
        updateWelcomeMessage();
      }
    }
    
    function updateWelcomeMessage() {
      // Already updated in HTML
    }
    
    // ===========================
    // EVENT LISTENERS SETUP
    // ===========================
    document.addEventListener('DOMContentLoaded', () => {
      // Navigation buttons
      document.getElementById('getStartedBtn').addEventListener('click', () => showPage('dashboard'));
      
      document.getElementById('homeNavBtn').addEventListener('click', (e) => {
        e.preventDefault();
        showPage('hero');
      });
      
      document.getElementById('dashboardNavBtn').addEventListener('click', (e) => {
        e.preventDefault();
        showPage('dashboard');
      });
      
      document.getElementById('installCheckBtn').addEventListener('click', (e) => {
        e.preventDefault();
        checkInstallStatus();
      });
      
      document.getElementById('aboutNavBtn').addEventListener('click', (e) => {
        e.preventDefault();
        showPage('about');
      });
      
      document.getElementById('exitAboutBtn').addEventListener('click', () => showPage('dashboard'));
      
      document.getElementById('exitFeatureBtn').addEventListener('click', () => {
        document.getElementById('alarmsFeature').style.display = 'none';
        document.getElementById('dictionaryFeature').style.display = 'none';
        document.getElementById('emergencyFeature').style.display = 'none';
        showPage('dashboard');
      });
      
      // Update button
      document.getElementById('updateButton').addEventListener('click', () => {
        updateApp();
      });
      
      // Feature cards
      document.querySelectorAll('.feature-card').forEach(card => {
        card.addEventListener('click', () => {
          const feature = card.getAttribute('data-feature');
          openFeature(feature);
        });
      });
      
      // Install PWA button
      document.getElementById('installPWAButton').addEventListener('click', () => {
        installPWA();
      });
      
      init();
    });
    
    // ===========================
    // FEATURE MANAGEMENT
    // ===========================
    function openFeature(feature) {
      // Hide all features first
      document.getElementById('alarmsFeature').style.display = 'none';
      document.getElementById('dictionaryFeature').style.display = 'none';
      document.getElementById('emergencyFeature').style.display = 'none';
      
      showPage('featureDetail');
      let headingText = '';
      let headingTranslation = '';
      
      if (feature === 'alarms') {
        headingText = 'Medicine Alarms';
        headingTranslation = 'Para Palagip iti Oras ti Panagtumar';
        document.getElementById('alarmsFeature').style.display = 'block';
        initAlarms();
      } else if (feature === 'dictionary') {
        headingText = 'Medicine Dictionary';
        headingTranslation = 'Diksyonaryo ti Agas';
        document.getElementById('dictionaryFeature').style.display = 'block';
        initDictionary();
      } else if (feature === 'emergency') {
        headingText = 'Emergency Guide';
        headingTranslation = 'Bayabay para iti Saan nga Mapakpakadaan a Pasamak';
        document.getElementById('emergencyFeature').style.display = 'block';
        initEmergency();
      }
      
      document.getElementById('featureDetailHeading').textContent = headingText;
      document.getElementById('featureDetailHeadingTranslation').textContent = headingTranslation;
    }
    
    // ===========================
    // MEDICINE ALARMS SYSTEM WITH DAY SELECTION
    // ===========================
    function initAlarms() {
      const alarmList = document.getElementById('alarmList');
      const addAlarmBtn = document.getElementById('addAlarmBtn');
      const frequencySelect = document.getElementById('frequency');
      const daysSelectionContainer = document.getElementById('daysSelectionContainer');
      const daysSelectionGrid = document.getElementById('daysSelectionGrid');
      let localAlarms = [...alarms];
      
      // Initialize day selection grid
      function initDaySelection() {
        daysSelectionGrid.innerHTML = '';
        
        DAYS.forEach(day => {
          const dayElement = document.createElement('div');
          dayElement.className = 'day-checkbox';
          dayElement.dataset.dayId = day.id;
          
          dayElement.innerHTML = `
            <div class="checkmark"></div>
            <div class="day-name">${day.short} <span class="translation" style="font-size: 0.7rem;">${day.translation}</span></div>
          `;
          
          dayElement.addEventListener('click', () => {
            dayElement.classList.toggle('selected');
          });
          
          daysSelectionGrid.appendChild(dayElement);
        });
        
        // Hide day selection initially
        daysSelectionContainer.classList.remove('active');
      }
      
      // Show/hide day selection based on frequency
      function toggleDaySelection() {
        if (frequencySelect.value === 'custom') {
          daysSelectionContainer.classList.add('active');
        } else {
          daysSelectionContainer.classList.remove('active');
        }
      }
      
      // Get selected days
      function getSelectedDays() {
        const selectedDays = [];
        const selectedElements = daysSelectionContainer.querySelectorAll('.day-checkbox.selected');
        
        selectedElements.forEach(element => {
          selectedDays.push(element.dataset.dayId);
        });
        
        return selectedDays;
      }
      
      // Format days for display
      function formatDaysForDisplay(daysArray) {
        if (!daysArray || daysArray.length === 0) return 'No days selected';
        
        const dayNames = daysArray.map(dayId => {
          const day = DAYS.find(d => d.id === dayId);
          return day ? day.short : dayId;
        });
        
        return dayNames.join(', ');
      }
      
      // Format days for display with translation
      function formatDaysWithTranslation(daysArray) {
        if (!daysArray || daysArray.length === 0) return '(Awan ti napili nga aldaw)';
        
        const dayNames = daysArray.map(dayId => {
          const day = DAYS.find(d => d.id === dayId);
          return day ? day.name : dayId;
        });
        
        return '(' + dayNames.join(', ') + ')';
      }
      
      function renderAlarms() {
        alarmList.innerHTML = '';
        if (localAlarms.length === 0) {
          alarmList.innerHTML = `
            <div class="text-center" style="padding: 30px; color: #666;">
              <i class="fas fa-bell-slash" style="font-size: 2rem; margin-bottom: 15px; color: #90e0ef;"></i>
              <p>No alarms set.</p>
              <p class="translation">(Awan ti alarma a na-set.)</p>
              <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                Set your first alarm using the form above.
                <span class="translation">(I-set ti umuna nga alarma babaen ti form iti ngato.)</span>
              </p>
            </div>`;
          return;
        }
        
        localAlarms.forEach(alarm => {
          const div = document.createElement('div');
          div.className = 'alarm-item';
          
          let frequencyDisplay = formatFrequency(alarm.frequency);
          let frequencyTranslation = formatFrequencyTranslation(alarm.frequency);
          
          // Add days info for custom frequency
          if (alarm.frequency === 'custom' && alarm.days && alarm.days.length > 0) {
            frequencyDisplay += `: ${formatDaysForDisplay(alarm.days)}`;
            frequencyTranslation += `: ${formatDaysWithTranslation(alarm.days)}`;
          }
          
          div.innerHTML = `
            <div class="alarm-details">
              <div class="alarm-time">${formatTime(alarm.alarmTime)}</div>
              <div class="alarm-medicine-info">
                <strong>${alarm.medicineName}</strong>
                <span class="translation">(${alarm.medicineName})</span>
              </div>
              <div class="alarm-frequency">
                Frequency: ${frequencyDisplay}
                <span class="translation">${frequencyTranslation}</span>
              </div>
            </div>
            <button class="deleteAlarmBtn" data-id="${alarm.id}" title="Delete alarm">
              <i class="fas fa-trash-alt"></i>
              <span class="translation">(Ikkaten)</span>
            </button>
          `;
          alarmList.appendChild(div);
        });
        
        // Delete listeners
        alarmList.querySelectorAll('.deleteAlarmBtn').forEach(btn => {
          btn.addEventListener('click', () => {
            const id = btn.getAttribute('data-id');
            // Clear any scheduled timeout
            const alarmToDelete = localAlarms.find(a => a.id == id);
            if (alarmToDelete && alarmToDelete.timeoutId) {
              clearTimeout(alarmToDelete.timeoutId);
            }
            
            localAlarms = localAlarms.filter(a => a.id != id);
            alarms = localAlarms;
            localStorage.setItem('mediCareAlarms', JSON.stringify(alarms));
            renderAlarms();
          });
        });
      }
      
      function formatTime(time) {
        const [hours, minutes] = time.split(':');
        const hour = parseInt(hours);
        const ampm = hour >= 12 ? 'PM' : 'AM';
        const formattedHour = hour % 12 || 12;
        return `${formattedHour}:${minutes} ${ampm}`;
      }
      
      function formatFrequency(frequency) {
        const frequencyMap = {
          'daily': 'Daily',
          'weekly': 'Weekly',
          'custom': 'Custom'
        };
        return frequencyMap[frequency] || frequency;
      }
      
      function formatFrequencyTranslation(frequency) {
        const translationMap = {
          'daily': '(Inaldaw-aldaw)',
          'weekly': '(Linawas)',
          'custom': '(Naisina a Oras)'
        };
        return translationMap[frequency] || frequency;
      }
      
      // Initialize day selection
      initDaySelection();
      
      // Add event listener for frequency change
      frequencySelect.addEventListener('change', toggleDaySelection);
      
      // Add alarm button event listener
      addAlarmBtn.addEventListener('click', () => {
        const medicineNameInput = document.getElementById('medicineName');
        const alarmTimeInput = document.getElementById('alarmTime');
        
        const medicineName = medicineNameInput.value.trim();
        const alarmTime = alarmTimeInput.value;
        const frequency = frequencySelect.value;
        
        if (!medicineName || !alarmTime) {
          showNotification('Please fill in all fields.', '(Punan dagiti fields.)', 'warning');
          return;
        }
        
        // For custom frequency, check if at least one day is selected
        if (frequency === 'custom') {
          const selectedDays = getSelectedDays();
          if (selectedDays.length === 0) {
            showNotification('Please select at least one day for custom frequency.', '(Pilian ti umuna nga aldaw para iti custom frequency.)', 'warning');
            return;
          }
        }
        
        const alarm = {
          id: Date.now(),
          medicineName,
          alarmTime,
          frequency,
          active: true,
          timeoutId: null
        };
        
        // Add days for custom frequency
        if (frequency === 'custom') {
          alarm.days = getSelectedDays();
        }
        
        localAlarms.push(alarm);
        alarms = localAlarms;
        localStorage.setItem('mediCareAlarms', JSON.stringify(alarms));
        renderAlarms();
        
        // Schedule the alarm
        alarm.timeoutId = scheduleAlarm(alarm);
        
        // Clear form
        medicineNameInput.value = '';
        alarmTimeInput.value = '';
        frequencySelect.value = 'daily';
        
        // Reset day selection
        daysSelectionContainer.querySelectorAll('.day-checkbox').forEach(day => {
          day.classList.remove('selected');
        });
        daysSelectionContainer.classList.remove('active');
        
        // Show success message
        let successMessage = `Alarm set for ${formatTime(alarmTime)}`;
        let successTranslation = `(Na-set ti alarma para iti ${formatTime(alarmTime)})`;
        
        if (frequency === 'custom' && alarm.days.length > 0) {
          successMessage += ` on ${formatDaysForDisplay(alarm.days)}`;
          successTranslation += ` idiay ${formatDaysWithTranslation(alarm.days)}`;
        }
        
        showNotification(successMessage, successTranslation, 'success');
      });
      
      renderAlarms();
    }
    
    // ===========================
    // ALARM SCHEDULING & TRIGGERING WITH DAY CHECK
    // ===========================
    function scheduleAlarm(alarm) {
      const now = new Date();
      const [hours, minutes] = alarm.alarmTime.split(':');
      let alarmTime = new Date();
      alarmTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
      
      // For custom frequency, find the next selected day
      if (alarm.frequency === 'custom' && alarm.days && alarm.days.length > 0) {
        alarmTime = getNextSelectedDay(alarmTime, alarm.days);
      } else {
        // For daily or weekly, if alarm time is in the past, schedule for tomorrow
        if (alarmTime <= now) {
          if (alarm.frequency === 'weekly') {
            alarmTime.setDate(alarmTime.getDate() + 7);
          } else {
            alarmTime.setDate(alarmTime.getDate() + 1);
          }
        }
      }
      
      const timeUntilAlarm = alarmTime.getTime() - now.getTime();
      
      // Schedule the alarm
      const timeoutId = setTimeout(() => {
        triggerAlarm(alarm);
        
        // Reschedule based on frequency
        if (alarm.frequency === 'daily') {
          const updatedAlarm = { ...alarm, active: true };
          scheduleAlarm(updatedAlarm);
        } else if (alarm.frequency === 'weekly') {
          const updatedAlarm = { ...alarm, active: true };
          setTimeout(() => {
            scheduleAlarm(updatedAlarm);
          }, 7 * 24 * 60 * 60 * 1000); // Schedule for next week
        } else if (alarm.frequency === 'custom' && alarm.days && alarm.days.length > 0) {
          const updatedAlarm = { ...alarm, active: true };
          setTimeout(() => {
            scheduleAlarm(updatedAlarm);
          }, 24 * 60 * 60 * 1000); // Check again tomorrow
        }
      }, timeUntilAlarm);
      
      return timeoutId;
    }
    
    // Helper function to get the next selected day for custom frequency
    function getNextSelectedDay(startDate, selectedDays) {
      const dayMap = {
        'sun': 0,
        'mon': 1,
        'tue': 2,
        'wed': 3,
        'thu': 4,
        'fri': 5,
        'sat': 6
      };
      
      const currentDay = startDate.getDay(); // 0 = Sunday, 1 = Monday, etc.
      
      // Convert selected days to their numeric values
      const selectedDayNumbers = selectedDays.map(dayId => dayMap[dayId]);
      
      // Sort the selected days
      selectedDayNumbers.sort((a, b) => a - b);
      
      // Find the next selected day
      for (let i = 0; i < selectedDayNumbers.length; i++) {
        if (selectedDayNumbers[i] > currentDay) {
          // Found a day later this week
          const daysToAdd = selectedDayNumbers[i] - currentDay;
          const nextDate = new Date(startDate);
          nextDate.setDate(startDate.getDate() + daysToAdd);
          return nextDate;
        }
      }
      
      // If no later days this week, take the first selected day next week
      const daysToAdd = (7 - currentDay) + selectedDayNumbers[0];
      const nextDate = new Date(startDate);
      nextDate.setDate(startDate.getDate() + daysToAdd);
      return nextDate;
    }
    
    function triggerAlarm(alarm) {
      currentAlarmActive = true;
      
      // Play sound
      playAlarmSound();
      
      // Show modal
      showAlarmModal(alarm);
      
      // Browser notification
      if ('Notification' in window && Notification.permission === 'granted') {
        new Notification('BasMedCa - Medicine Time', {
          body: `Time to take ${alarm.medicineName}`,
          icon: 'logo.png',
          requireInteraction: true,
          tag: 'medicine-reminder'
        });
      }
      
      // Vibrate if supported
      if (navigator.vibrate && platform.isMobile) {
        navigator.vibrate([200, 100, 200, 100, 200]);
      }
    }
    
// ===========================
// ALARM SOUND SYSTEM - FASTER & LOUDER
// ===========================
function playAlarmSound() {
  if (!window.AudioContext && !window.webkitAudioContext) {
    console.log('AudioContext not supported');
    playSimpleBeep();
    return;
  }
  
  try {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    currentAlarmAudioContext = audioContext;
    
    // Resume AudioContext if suspended (mobile browsers)
    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }
    
    // Create oscillators for a more complex, louder sound
    const oscillator1 = audioContext.createOscillator();
    const oscillator2 = audioContext.createOscillator();
    const gainNode1 = audioContext.createGain();
    const gainNode2 = audioContext.createGain();
    const masterGain = audioContext.createGain();
    
    // Connect oscillators to gain nodes
    oscillator1.connect(gainNode1);
    oscillator2.connect(gainNode2);
    gainNode1.connect(masterGain);
    gainNode2.connect(masterGain);
    masterGain.connect(audioContext.destination);
    
    // Higher volume
    masterGain.gain.setValueAtTime(0.9, audioContext.currentTime);
    
    // Set up first oscillator - main beep sound
    oscillator1.frequency.setValueAtTime(880, audioContext.currentTime); // Higher pitch (A5)
    oscillator1.type = 'sawtooth'; // More aggressive sound
    
    // Set up second oscillator - harmony for more noticeable sound
    oscillator2.frequency.setValueAtTime(660, audioContext.currentTime); // E5 - creates chord
    oscillator2.type = 'square'; // Harsh, attention-grabbing sound
    
    // FASTER beeping pattern - more urgent
    const beepCount = 6;
    for (let i = 0; i < beepCount; i++) {
      const startTime = audioContext.currentTime + (i * 0.2); // Faster: every 0.2 seconds
      const stopTime = startTime + 0.1; // Shorter beep duration
      
      gainNode1.gain.setValueAtTime(0.8, startTime);
      gainNode1.gain.exponentialRampToValueAtTime(0.01, stopTime);
      
      gainNode2.gain.setValueAtTime(0.6, startTime);
      gainNode2.gain.exponentialRampToValueAtTime(0.01, stopTime);
    }
    
    // Start and stop oscillators
    oscillator1.start(audioContext.currentTime);
    oscillator1.stop(audioContext.currentTime + (beepCount * 0.2));
    
    oscillator2.start(audioContext.currentTime);
    oscillator2.stop(audioContext.currentTime + (beepCount * 0.2));
    
    // Create additional beep pattern using setTimeout for more noticeable alerts
    let beepCounter = 0;
    const beepInterval = setInterval(() => {
      if (beepCounter < 3 && currentAlarmActive) {
        // Play a single beep
        const beepOsc = audioContext.createOscillator();
        const beepGain = audioContext.createGain();
        beepOsc.connect(beepGain);
        beepGain.connect(audioContext.destination);
        beepOsc.frequency.setValueAtTime(1000, audioContext.currentTime);
        beepOsc.type = 'sine';
        beepGain.gain.setValueAtTime(0.5, audioContext.currentTime);
        beepGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
        beepOsc.start(audioContext.currentTime);
        beepOsc.stop(audioContext.currentTime + 0.15);
        beepCounter++;
      } else {
        clearInterval(beepInterval);
      }
    }, 2000); // Repeat every 2 seconds for extra reminder
    
    // Store interval to clear later
    currentAlarmSoundInterval = beepInterval;
    
  } catch (error) {
    console.log('Audio error, using fallback:', error);
    playSimpleBeep();
  }
}

// Fallback simple beep using Web Audio API
function playSimpleBeep() {
  try {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }
    
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
    oscillator.type = 'sine';
    
    gainNode.gain.setValueAtTime(0.7, audioContext.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
    
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime + 0.5);
    
    // Repeat the beep
    currentAlarmSoundInterval = setInterval(() => {
      if (currentAlarmActive) {
        const newOsc = audioContext.createOscillator();
        const newGain = audioContext.createGain();
        newOsc.connect(newGain);
        newGain.connect(audioContext.destination);
        newOsc.frequency.setValueAtTime(800, audioContext.currentTime);
        newOsc.type = 'sine';
        newGain.gain.setValueAtTime(0.5, audioContext.currentTime);
        newGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
        newOsc.start(audioContext.currentTime);
        newOsc.stop(audioContext.currentTime + 0.3);
      }
    }, 2000);
    
  } catch (e) {
    console.log('â° MEDICINE TIME! Please take your medication.');
  }
}

function stopAlarmSound() {
  if (currentAlarmSoundInterval) {
    clearInterval(currentAlarmSoundInterval);
    currentAlarmSoundInterval = null;
  }
  if (currentAlarmAudioContext) {
    try {
      currentAlarmAudioContext.close();
    } catch (e) {
      // Ignore
    }
    currentAlarmAudioContext = null;
  }
  currentAlarmActive = false;
}
    
// === Medicine Dictionary - COMPLETE (Shows all items below search) ===
function initDictionary() {
  const medicines = [
    {
      category: 'Pain Relievers',
      categoryTranslation: '(Pampababa ti Sakit)',
      items: [
        { name: 'Ibuprofen', description: 'Helps with pain, fever, and swelling. Good for headaches and muscle aches.', descriptionTranslation: '(Makatulong iti sakit, gurigor, ken panagngelngel. Maayo para iti sakit ti bungo ken sakit ti muscle.)' },
        { name: 'Acetaminophen', description: 'Reduces pain and fever. Common for colds, flu, and general aches.', descriptionTranslation: '(Pabassiten ti sakit ken gurigor. Kadawyan para iti sipon, trangkaso, ken sabsabali a sakit.)' },
        { name: 'Aspirin', description: 'Used for pain, fever, and swelling. Can also help prevent blood clots (ask a doctor).', descriptionTranslation: '(Usaren para iti sakit, gurigor, ken panagngelngel. Makatulong met a manglapped iti panagbekkel ti dara (agsaludsod iti doktor).)' },
        { name: 'Alaxan', description: 'Relieves body pain and inflammation from its source. Take as directed.', descriptionTranslation: '(Makatulong a mangpalpak ti sakit ti bagi ken inflammation. Agtumar kas imbilin.)' },
        { name: 'Bioflu', description: 'Helps relieve fever, cough, runny nose, and body pain.', descriptionTranslation: '(Tumulong nga mangbabaw ti gurigor, uyek, sipon, ken sakit ti bagbagi.)' }
      ]
    },
    {
      category: 'Blood Pressure Medications',
      categoryTranslation: '(Agas para iti Alta Presyon)',
      items: [
        { name: 'Lisinopril', description: 'Helps relax blood vessels to lower high blood pressure. Take as directed by your doctor.', descriptionTranslation: '(Makatulong a mangpalukneng kadagiti dara ti urat tapno pabassiten ti alta presyon. Agtumar kas imbilin ti doktor.)' },
        { name: 'Amlodipine', description: 'Works by relaxing blood vessels, making it easier for your heart to pump blood. Used for high blood pressure and chest pain.', descriptionTranslation: '(Agtrabaho babaen ti panangpalukneng kadagiti urat ti dara, a mangpalaka iti panagbomba ti puso iti dara. Usaren para iti alta presyon ken sakit ti barukong.)' },
        { name: 'Losartan', description: 'Helps relax blood vessels to lower high blood pressure. Important to take regularly.', descriptionTranslation: '(Makatulong a mangpalukneng kadagiti urat ti dara tapno pabassiten ti alta presyon. Importante a regular nga agtumar.)' },
        { name: 'Calcibloc', description: 'Helps to lower blood pressure and treat heart problems. Consult a doctor for detailed usage.', descriptionTranslation: '(Makatulong a pabassiten ti presyon ti dara ken mangagas kadagiti problema ti puso. Agsaludsod iti doktor para iti naimbag a panagusar.)' }
      ]
    },
    {
      category: 'Diabetes Medications',
      categoryTranslation: '(Agas para iti Diabetes)',
      items: [
        { name: 'Metformin', description: 'Helps your body use insulin better and lowers sugar made by your liver. For type 2 diabetes.', descriptionTranslation: '(Makatulong iti bagim a nasaysayaat nga usaren ti insulin ken pabassiten ti asukar nga aramiden ti ataymo. Para iti type 2 diabetes.)' },
        { name: 'Insulin', description: 'A hormone that helps sugar get into your cells for energy. Used for both type 1 and some type 2 diabetes.', descriptionTranslation: '(Maysa a hormone a makatulong iti asukar a sumrek kadagiti selulam para iti enerhiya. Usaren para iti type 1 ken dadduma a type 2 diabetes.)' },
        { name: 'Gliclazide', description: 'Helps control blood sugar levels for people with type 2 diabetes. Do not skip meals while taking it. Consult a doctor for detailed usage.', descriptionTranslation: '(Makatulong a mangkontrol ti blood sugar levels para kadagiti tao nga adda type 2 diabetes. Saan a laktawan ti makan agraman no agtumar. Agsaludsod iti doktor para iti naimbag a panagusar.)' }
      ]
    },
    {
      category: 'Antibiotics',
      categoryTranslation: '(Antibiotiko)',
      items: [
        { name: 'Amoxicillin', description: 'Fights bacterial infections like ear infections, strep throat, and pneumonia. Finish the full course even if you feel better.', descriptionTranslation: '(Manglaban kadagiti impeksyon ti bakterya kas iti impeksyon ti lapayag, strep throat, ken pneumonia. Tapusen ti intero a kurso uray no nasaysayaat ti riknam.)' },
        { name: 'Azithromycin', description: 'Treats various bacterial infections, including some respiratory and skin infections. Take as prescribed.', descriptionTranslation: '(Mangagas kadagiti nadumaduma a impeksyon ti bakterya, agraman dagiti impeksyon ti panaganges ken kudil. Agtumar kas nareseta.)' }
      ]
    },
    {
      category: 'Antacids',
      categoryTranslation: '(Antasid)',
      items: [
        { name: 'Omeprazole', description: 'Reduces the amount of acid your stomach makes. Used for heartburn and acid reflux.', descriptionTranslation: '(Pabassiten ti kaadu ti asido nga aramiden ti tiyanmo. Usaren para iti heartburn ken acid reflux.)' },
        { name: 'Ranitidine', description: 'Lowers stomach acid. Helps with heartburn and ulcers. Note: Check with your doctor as it may be recalled in some regions.', descriptionTranslation: '(Pabassiten ti asido ti tiyan. Makatulong iti heartburn ken ulser. Pauna: Agsaludsod iti doktor no naala manen kadagiti dadduma a rehion.)' },
        { name: 'Maalox', description: 'Relieves heartburn, acid indigestion, and stomach pain. Neutralizes stomach acid. Take after meals and not with other medicines.', descriptionTranslation: '(Makatulong a mangpalpak ti heartburn, acid indigestion, ken sakit ti tiyan. Neutralizes ti asido ti tiyan. Agtumar babaen ti makan ken saan a same time iti sabsabali a agas.)' }
      ]
    },
    {
      category: 'Vitamins',
      categoryTranslation: '(Bitamina)',
      items: [
        { name: 'Mutilem', description: 'A multivitamin supplement to support overall health. Consult a doctor for detailed usage.', descriptionTranslation: '(Maysa a multivitamin supplement a mangsuporta iti overall health. Agsaludsod iti doktor para iti naimbag a panagusar.)' },
        { name: 'Vitamin B-Complex', description: 'Supports energy production and nerve health. Common for fatigue and stress relief. Consult a doctor for detailed usage.', descriptionTranslation: '(Mangsuporta iti energy production ken nerve health. Kadawyan para iti panagpangpangawa ken stress relief. Agsaludsod iti doktor para iti naimbag a panagusar.)' }
      ]
    },
    {
      category: 'Gout',
      categoryTranslation: '(Agas para iti Gout)',
      items: [
        { name: 'Allopurinol', description: 'Reduces uric acid levels to prevent gout attacks. Take as prescribed by a doctor.', descriptionTranslation: '(Pabassiten ti uric acid levels tapno manglapped iti gout attacks. Agtumar kas nareseta ti doktor.)' }
      ]
    },
    {
      category: 'Anti-Vertigo',
      categoryTranslation: '(Agas para iti Anti-Vertigo)',
      items: [
        { name: 'Betahistine', description: 'Helps reduce dizziness and vertigo symptoms. Consult a doctor for detailed usage.', descriptionTranslation: '(Makatulong a pabassiten ti dizziness ken vertigo symptoms. Agsaludsod iti doktor para iti naimbag a panagusar.)' },
        { name: 'Cinnarizine', description: 'Treats motion sickness and vertigo. Take before travel if needed. Consult a doctor for detailed usage.', descriptionTranslation: '(Mangagas iti motion sickness ken vertigo. Agtumar a mangrugi no needed para iti travel. Agsaludsod iti doktor para iti naimbag a panagusar.)' },
        { name: 'Bonamine', description: 'Prevents nausea and vertigo, especially from motion. Consult a doctor for detailed usage.', descriptionTranslation: '(Manglapped iti nausea ken vertigo, agraman iti motion. Agsaludsod iti doktor para iti naimbag a panagusar.)' }
      ]
    },
    {
      category: 'Fever, Coughs, and Cold',
      categoryTranslation: '(Gurigor, Uyek, ken Sipon)',
      items: [
        { name: 'Neozep', description: 'Used for colds and allergies.', descriptionTranslation: '(Mausar para iti allergy ken sipon.)' },
        { name: 'Solmux', description: 'Helps to remove phlegm and makes coughing easier.', descriptionTranslation: '(Makatulong nga mangikkat iti plema ken palakaen na iti pinag-uyek.)' },
        { name: 'Biogesic', description: 'Used to relieve pain, fever, headache, body pain, and even head aches.', descriptionTranslation: '(Mausar para pagpaay iti sakit, gurigor, sakit ti ulo, sakit ti bagbagi, ken uray sakit ti ngipen.)' }
      ]
    },
    {
      category: 'High Cholesterol',
      categoryTranslation: '(Nangato nga Cholesterol)',
      items: [
        { name: 'Atorvastatin', description: 'Lowers bad cholesterol and helps prevent heart attacks and strokes.', descriptionTranslation: '(Mangibaba ti madi a cholesterol ken tumulong nga mangiliklik iti atake ti puso ken stroke.)' },
        { name: 'Simvastatin', description: 'Used to control cholesterol levels in the blood and helps keep the heart healthy.', descriptionTranslation: '(Mang-kontrol iti kolesterol iti dara ken tumulong nga agtalinaed a nasayaat ti puso.)' }
      ]
    },
    {
      category: 'Allergies',
      categoryTranslation: '(Para Allergies)',
      items: [
        { name: 'Cetirizine', description: 'Used to relieve sneezing, runny nose, watery eyes, and allergies.', descriptionTranslation: '(Mausar tapno mapukaw ti pangbaen, panagsaloy ti sipon, agluw-luwa nga mat-mata, ken alerhiya.)' }
      ]
    }
  ];

  const medicineList = document.getElementById('medicineList');
  const medicineSearch = document.getElementById('medicineSearch');

  // Function to show all medicines (no filter)
  function showAllMedicines() {
    medicineList.innerHTML = '';
    
    medicines.forEach(category => {
      const catDiv = document.createElement('div');
      catDiv.className = 'medicine-category';

      const header = document.createElement('div');
      header.className = 'category-header';
      header.innerHTML = `
        <span>${category.category} <span class="translation">${category.categoryTranslation}</span></span>
        <span><i class="fas fa-chevron-down"></i></span>
      `;

      const content = document.createElement('div');
      content.className = 'category-content';
      content.style.display = 'block'; // Always visible by default

      category.items.forEach(item => {
        const medDiv = document.createElement('div');
        medDiv.className = 'medicine-item';

        medDiv.innerHTML = `
          <h4>${item.name} <span class="translation">(${item.name})</span></h4>
          <p class="step-text">${item.description}</p>
          <p class="step-translation">${item.descriptionTranslation}</p>
        `;

        content.appendChild(medDiv);
      });

      catDiv.appendChild(header);
      catDiv.appendChild(content);
      medicineList.appendChild(catDiv);
    });
  }

  // Filter medicines based on search
  function filterMedicines(filter) {
    medicineList.innerHTML = '';
    const lowerFilter = filter.toLowerCase();
    let foundAny = false;

    medicines.forEach(category => {
      const filteredItems = category.items.filter(item => {
        const lowerName = item.name.toLowerCase();
        const lowerDesc = item.description.toLowerCase();
        const lowerDescTrans = item.descriptionTranslation.toLowerCase();
        
        return lowerName.includes(lowerFilter) || 
               lowerDesc.includes(lowerFilter) || 
               lowerDescTrans.includes(lowerFilter);
      });

      if (filteredItems.length > 0) {
        foundAny = true;
        const catDiv = document.createElement('div');
        catDiv.className = 'medicine-category';

        const header = document.createElement('div');
        header.className = 'category-header';
        header.innerHTML = `
          <span>${category.category} <span class="translation">${category.categoryTranslation}</span></span>
          <span><i class="fas fa-chevron-down"></i></span>
        `;

        const content = document.createElement('div');
        content.className = 'category-content';
        content.style.display = 'block';

        filteredItems.forEach(item => {
          const medDiv = document.createElement('div');
          medDiv.className = 'medicine-item';

          medDiv.innerHTML = `
            <h4>${item.name} <span class="translation">(${item.name})</span></h4>
            <p class="step-text">${item.description}</p>
            <p class="step-translation">${item.descriptionTranslation}</p>
          `;

          content.appendChild(medDiv);
        });

        catDiv.appendChild(header);
        catDiv.appendChild(content);
        medicineList.appendChild(catDiv);
      }
    });

    if (!foundAny) {
      medicineList.innerHTML = '<p style="color:#5a6c7d; text-align:center; padding:20px 0;">No medicines found matching your search. <span class="translation">(Awan ti agas a kapada ti inaramid mo a panagbiruk.)</span></p>';
    }
  }

  // Add click event to toggle categories
  medicineList.addEventListener('click', (e) => {
    const header = e.target.closest('.category-header');
    if (header) {
      const content = header.nextElementSibling;
      const icon = header.querySelector('.fa-chevron-down');
      if (content.style.display === 'none') {
        content.style.display = 'block';
        icon.style.transform = 'rotate(0deg)';
      } else {
        content.style.display = 'none';
        icon.style.transform = 'rotate(-90deg)';
      }
    }
  });

  // Search input event
  medicineSearch.addEventListener('input', () => {
    if (medicineSearch.value.trim() === '') {
      showAllMedicines(); // Show all when search is empty
    } else {
      filterMedicines(medicineSearch.value);
    }
  });

  // Initial load - show all medicines
  showAllMedicines();
}

// === Emergency Guide (Step-by-Step) - COMPLETE (Shows all emergencies below search) ===
function initEmergency() {
  const emergencies = [
    {
      title: 'Dizziness or Lightheadedness',
      titleTranslation: '(Panagulaw)',
      keywords: ['Dizziness', 'Maulaw', 'Lightheadedness', 'Agkakapsut'],
      steps: [
        { text: 'Sit still or lie down right away.', translation: '(Agtugaw wenno agidda a sigud.)' },
        { text: 'Drink water or juice slowly.', translation: '(Innayaden nga uminom ti danum wenno juice.)' },
        { text: 'Take deep, steady breaths.', translation: '(Aganges ti nauneg ken nainnayad.)' },
        { text: 'Rest until you feel stable before standing again.', translation: '(Aginana aginggana mayat ti rikna sakbay a tumakder manen.)' }
      ]
    },
    {
      title: 'Fever or Flu',
      titleTranslation: '(Gurigor)',
      keywords: ['Trangkaso', 'Gurigor', 'Fever', 'Flu'],
      steps: [
        { text: 'Take temperature and note it down.', translation: '(Alaen ti temparatura ti bagi ken tandaanan.)' },
        { text: 'Drink or eat plenty of fluid like water or soup.', translation: '(Mangan wenno umigop ti addu a danum wennu digo.)' },
        { text: 'Take paracetamol if fever is high.', translation: '(Agtumar ti paracetamol nu nangato ti gurigor.)' },
        { text: 'Rest in a cool, quiet room and monitor your condition.', translation: '(Aginana ayanti nalamiis ken naulimek a lugar ken bantayan ti rikriknaem.)' }
      ]
    },
    {
      title: 'Allergic Reaction',
      titleTranslation: '(Reaksyon ti Allergy)',
      keywords: ['allergy', 'reaction', 'anaphylaxis', 'hives', 'swelling'],
      steps: [
        { text: 'Move away from what caused the allergy.', translation: '(Umadayo iti naggapwan iti alerhiya.)' },
        { text: 'Take Cetirizine if symptoms are mild like sneezing or itchy skin.', translation: '(Agtumar ti Cetirizine no haan unay a nakaro ti sintomas kasla panagbaeng ken nabudo a kudil.)' },
        { text: 'Use the EpiPen if it gets worse or breathing becomes hard.', translation: '(Agusar ti EpiPen nu kumaro wenno magitan ka nga umages.)' },
        { text: 'Call for help or go to the nearest clinic right away.', translation: '(Tumawag iti tulong wenno mapan ti asideg nga clinic a sigod.)' }
      ]
    },
    {
      title: 'Scrapes or Cuts',
      titleTranslation: '(Sugat)',
      keywords: ['sugat', 'wound', 'cut', 'blood'],
      steps: [
        { text: 'Wash hands thoroughly.', translation: '(Bugwan a nasayaat ti im-ima.)' },
        { text: 'Clean the wound gently with soap and water.', translation: '(Agusar ti sabon ken danum ken innayaden nga dalusan iti sugat.)' },
        { text: 'Apply antiseptic or alcohol-free wound ointment.', translation: '(Agusar ti antiseptic wenno wound ointemnt nga awan ti alcohol.)' },
        { text: 'Cover with a clean bandage and change daily.', translation: '(Agusar ti nadalus nga bandage a pangtakkob ti sugat ken suktan nga innaldaw.)' }
      ]
    },
    {
      title: 'Indigestion',
      titleTranslation: '(Sakit ti Buksit)',
      keywords: ['Indigestion', 'Stomach Pain', 'Sakit ti Tiyan'],
      steps: [
        { text: 'Stop eating for a few hours. Let your stomach rest.', translation: '(Isardeng ti mangan ti mano nga oras tapno paginanaen ti tiyan.)' },
        { text: 'Sip water slowly to stay hydrated.', translation: '(Innayaden nga uminom ti danum.)' },
        { text: 'Eat bland food like rice, banana, or crackers.', translation: '(Mangan ti natatamnay nga makan kasla inapoy, saba, wennu biskwit.)' },
        { text: 'Take antacid if needed and avoid greasy or spicy foods.', translation: '(Agtumar ti para sakit ti tiyan ken lik-likan ti mangan ti namantika ken naadat nga mak-makan.)' }
      ]
    },
    {
      title: 'Small Burns (1st Degree Only)',
      titleTranslation: '(Nasinit)',
      keywords: ['burns', 'nasinit', 'heat', 'scald'],
      steps: [
        { text: 'Cool the burnt area with cool (not icy cold) running water for 10-15 minutes.', translation: '(Palamiisen ti nasinit nga parte ti bagi, agusar iti agtar-taray ken nalamis ngem haan nga agyel-yelo nga danum. Aramiden detuy ti 10-15 a minuto.)' },
        { text: 'Gently pat dry with a clean towel.', translation: '(Innayaden nga punasan ti nadalus a lupot.)' },
        { text: 'Apply aloe vera gel or burn cream.', translation: '(Agusar ti aloe vera gel wennu burn cream.)' },
        { text: 'Leave it loosely covered to heal.', translation: '(Baybay-an a nalukay ti pannakabungon na.)' }
      ]
    },
    {
      title: 'Joint Pain',
      titleTranslation: '(Joint Pain)',
      keywords: ['nasakit', 'joint', 'arthritis', 'nasakit nga joints'],
      steps: [
        { text: 'Stop moving the sore area and rest.', translation: '(Pagina-naen wennu haan nga gargarawen iti nasakit a parte.)' },
        { text: 'Wrap with a bandage or lightly compress.', translation: '(Bungunen ti bandage wennu piriten a nalag-an.)' },
        { text: 'Apply ice for 15-20 minutes every hour.', translation: '(Ikkan ti yelo iti uneg ti 15-20 nga minuto kada oras.)' },
        { text: 'Keep it elevated above heart level to reduce swelling.', translation: '(Italinaed nga nangat-ngato ngem ti puso tapno haan nga lumteg.)' }
      ]
    },
    {
      title: 'Head Ache',
      titleTranslation: '(Sakit ti Ulo)',
      keywords: ['sakit ti ulo', 'head ache'],
      steps: [
        { text: 'Rest in a quiet, calm, and dark place to relax your eyes.', translation: '(Agin-nana iti naulimek, kalmado, ken nalidem a lugar tapno i-relax ti mata.)' },
        { text: 'Drink water.', translation: '(Uminum ti danum.)' },
        { text: 'Avoid bright lights and loud sounds.', translation: '(Umiwas iti nalawag nga silaw ken natatagari nga un-uni.)' },
        { text: 'Take medicine, specifically pain relievers.', translation: '(Agtumar ti agas lalo iti pain relievers.)' }
      ]
    }
  ];

  const emergencyList = document.getElementById('emergencyList');
  const emergencySearch = document.getElementById('emergencySearch');

  // Function to show all emergencies
  function showAllEmergencies() {
    emergencyList.innerHTML = '';
    
    emergencies.forEach(emergency => {
      const card = document.createElement('div');
      card.className = 'emergency-card';

      const title = document.createElement('h3');
      title.innerHTML = `
        ${emergency.title} <span class="translation">${emergency.titleTranslation}</span>
        <span><i class="fas fa-chevron-down"></i></span>
      `;

      const stepsDiv = document.createElement('div');
      stepsDiv.className = 'emergency-steps';
      stepsDiv.style.display = 'block'; // Always visible by default

      const ol = document.createElement('ol');
      emergency.steps.forEach((step, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span class="step-text">${step.text}</span>
          <span class="step-translation">${step.translation}</span>
          ${step.image ? `<img src="${step.image}" alt="Step ${index + 1} for ${emergency.title}: ${step.text.substring(0, 50)}..." class="step-image">` : ''}
        `;
        ol.appendChild(li);
      });

      stepsDiv.appendChild(ol);
      card.appendChild(title);
      card.appendChild(stepsDiv);
      emergencyList.appendChild(card);
    });
  }

  // Filter emergencies based on search
  function filterEmergencies(filter) {
    emergencyList.innerHTML = '';
    const lowerFilter = filter.toLowerCase();
    let foundAny = false;

    emergencies.forEach(emergency => {
      const matchesTitle = emergency.title.toLowerCase().includes(lowerFilter) ||
                           emergency.titleTranslation.toLowerCase().includes(lowerFilter);
      const matchesKeywords = emergency.keywords.some(k => k.toLowerCase().includes(lowerFilter));
      const matchesSteps = emergency.steps.some(step =>
        step.text.toLowerCase().includes(lowerFilter) ||
        step.translation.toLowerCase().includes(lowerFilter)
      );
      
      if (!matchesTitle && !matchesKeywords && !matchesSteps) return;

      foundAny = true;
      const card = document.createElement('div');
      card.className = 'emergency-card';

      const title = document.createElement('h3');
      title.innerHTML = `
        ${emergency.title} <span class="translation">${emergency.titleTranslation}</span>
        <span><i class="fas fa-chevron-down"></i></span>
      `;

      const stepsDiv = document.createElement('div');
      stepsDiv.className = 'emergency-steps';
      stepsDiv.style.display = 'block';

      const ol = document.createElement('ol');
      emergency.steps.forEach((step, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span class="step-text">${step.text}</span>
          <span class="step-translation">${step.translation}</span>
          ${step.image ? `<img src="${step.image}" alt="Step ${index + 1} for ${emergency.title}: ${step.text.substring(0, 50)}..." class="step-image">` : ''}
        `;
        ol.appendChild(li);
      });

      stepsDiv.appendChild(ol);
      card.appendChild(title);
      card.appendChild(stepsDiv);
      emergencyList.appendChild(card);
    });

    if (!foundAny) {
      emergencyList.innerHTML = '<p style="color:#5a6c7d; text-align:center; padding:20px 0;">No emergencies found matching your search. <span class="translation">(Awan ti emerhensya a kapada ti inaramid mo a panagbiruk.)</span></p>';
    }
  }

  // Add click event to toggle emergency steps
  emergencyList.addEventListener('click', (e) => {
    const title = e.target.closest('.emergency-card h3');
    if (title) {
      const stepsDiv = title.nextElementSibling;
      const icon = title.querySelector('.fa-chevron-down');
      if (stepsDiv.style.display === 'none') {
        stepsDiv.style.display = 'block';
        icon.style.transform = 'rotate(0deg)';
      } else {
        stepsDiv.style.display = 'none';
        icon.style.transform = 'rotate(-90deg)';
      }
    }
  });

  // Search input event
  emergencySearch.addEventListener('input', () => {
    if (emergencySearch.value.trim() === '') {
      showAllEmergencies(); // Show all when search is empty
    } else {
      filterEmergencies(emergencySearch.value);
    }
  });

  // Initial load - show all emergencies
  showAllEmergencies();
}
    
    // ===========================
    // EMERGENCY HOTLINES
    // ===========================
    function renderEmergencyContacts() {
      const hotlines = [
        { name: 'FNLGHTC', number: '0966-612-2623' },
        { name: 'FNLGHTC No. 2', number: '0919-328-1763' },
        { name: 'MHO', number: '0905-799-2922' },
        { name: 'MPS (Police)', number: '0998-598-7730' }
      ];
      
      const hotlinesContentDiv = document.getElementById('hotlinesContent');
      const emergencyHotlinesToggle = document.getElementById('emergencyHotlinesToggle');
      
      if (!hotlinesContentDiv || !emergencyHotlinesToggle) return;
      
      hotlinesContentDiv.innerHTML = '';
      
      hotlines.forEach(contact => {
        const contactDiv = document.createElement('div');
        contactDiv.className = 'contact-item';
        
        contactDiv.innerHTML = `
          <strong>${contact.name}</strong>
          <a href="tel:${contact.number}">${contact.number}</a>
          <div class="contact-translation">(Tawagan ti ${contact.name})</div>
        `;
        
        hotlinesContentDiv.appendChild(contactDiv);
      });
      
      let isOpen = false;
      
      emergencyHotlinesToggle.addEventListener('click', function(e) {
        e.preventDefault();
        
        if (!isOpen) {
          hotlinesContentDiv.classList.add('open');
          this.setAttribute('aria-expanded', 'true');
          this.querySelector('.fa-chevron-down').style.transform = 'rotate(180deg)';
          isOpen = true;
        } else {
          hotlinesContentDiv.classList.remove('open');
          this.setAttribute('aria-expanded', 'false');
          this.querySelector('.fa-chevron-down').style.transform = 'rotate(0deg)';
          isOpen = false;
        }
      });
      
      hotlinesContentDiv.classList.remove('open');
      emergencyHotlinesToggle.setAttribute('aria-expanded', 'false');
    }
    
    // ===========================
    // PWA INSTALLATION SYSTEM - IMPROVED
    // ===========================
    function initPWA() {
      // Register Service Worker
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('service-worker.js')
            .then(registration => {
              console.log('ServiceWorker registered successfully');
              
              // Check for updates periodically
              setInterval(() => {
                registration.update();
              }, 24 * 60 * 60 * 1000); // Check every 24 hours
              
              // Listen for updates
              registration.addEventListener('updatefound', () => {
                const newWorker = registration.installing;
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    document.getElementById('updateNotification').classList.add('show');
                  }
                });
              });
            })
            .catch(error => {
              console.log('ServiceWorker registration failed:', error);
            });
        });
      }
      
      // Listen for beforeinstallprompt event
      window.addEventListener('beforeinstallprompt', (e) => {
        console.log('beforeinstallprompt event fired');
        e.preventDefault();
        deferredPrompt = e;
        
        // Only show install button if not already installed
        if (!installationMethods.isInstalled()) {
          document.getElementById('installPWAButton').style.display = 'flex';
        }
      });
      
      // Listen for appinstalled event
      window.addEventListener('appinstalled', () => {
        console.log('App was installed');
        installationMethods.markAsInstalled();
        document.getElementById('installPWAButton').style.display = 'none';
        document.body.classList.add('pwa-installed');
        showNotification('BasMedCa installed successfully!', '(Na-install ti BasMedCa!)', 'success');
      });
      
      // Check on load if already installed
      if (installationMethods.isInstalled()) {
        document.getElementById('installPWAButton').style.display = 'none';
        document.body.classList.add('pwa-installed');
      }
    }
    
    function installPWA() {
      if (!deferredPrompt) {
        showNotification('Installation not available', '(Saan nga available ti installation)', 'warning');
        return;
      }
      
      // Show the install prompt
      deferredPrompt.prompt();
      
      // Wait for the user to respond to the prompt
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the PWA installation');
          installationMethods.markAsInstalled();
          showNotification('Installing BasMedCa...', '(Ag-install ti BasMedCa...)', 'info');
        } else {
          console.log('User dismissed the PWA installation');
          showNotification('Installation cancelled', '(Naikkat ti installation)', 'warning');
        }
        deferredPrompt = null;
      });
    }
    
    function checkInstallStatus() {
      const isInstalled = installationMethods.isInstalled();
      
      if (isInstalled) {
        showNotification(
          'BasMedCa is already installed!', 
          '(Na-installen ti BasMedCa!)', 
          'success'
        );
      } else {
        showNotification(
          'Not installed yet. Use the Install button below.', 
          '(Saan pay na-install. Usaren ti Install button dita baba.)', 
          'info'
        );
        
        // Show install button if available
        const installButton = document.getElementById('installPWAButton');
        if (installButton.style.display === 'none' && deferredPrompt) {
          installButton.style.display = 'flex';
          installButton.scrollIntoView({ behavior: 'smooth' });
        }
      }
      
      // Also log detailed information for debugging
      console.log('Installation status check:', {
        displayMode: window.matchMedia('(display-mode: standalone)').matches,
        standalone: window.navigator.standalone,
        serviceWorkerControlled: installationMethods.isServiceWorkerControlled(),
        localStorageFlag: localStorage.getItem('pwaInstalled'),
        deferredPrompt: !!deferredPrompt
      });
    }
    
    function updateApp() {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.ready.then(registration => {
          registration.update();
          document.getElementById('updateNotification').classList.remove('show');
          showNotification('Updating app...', '(Ag-update ti app...)', 'info');
          setTimeout(() => {
            window.location.reload();
          }, 1000);
        });
      }
    }
    
    // ===========================
    // NOTIFICATION SYSTEM
    // ===========================
    function showNotification(message, translation, type = 'info') {
      const notification = document.createElement('div');
      const bgColor = type === 'success' ? '#4CAF50' : type === 'warning' ? '#ff9800' : '#0077b6';
      
      notification.innerHTML = `
        <div style="
          position: fixed;
          top: 20px;
          right: 20px;
          background: ${bgColor};
          color: white;
          padding: 15px 20px;
          border-radius: 10px;
          z-index: 10001;
          box-shadow: 0 4px 12px rgba(0,0,0,0.2);
          max-width: 300px;
          animation: slideInRight 0.3s ease;
        ">
          <div style="display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
            <div>
              <div style="font-weight: 600;">${message}</div>
              <div style="font-size: 0.9rem; opacity: 0.9;">${translation}</div>
            </div>
          </div>
        </div>
        <style>
          @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
          }
        </style>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (notification.parentElement) notification.remove();
      }, 3000);
    }
    
    // Request notification permission on load
    if ('Notification' in window && Notification.permission === 'default') {
      setTimeout(() => {
        Notification.requestPermission();
      }, 3000);
    }
  </script>
</body>
</html>

